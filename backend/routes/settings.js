const express = require("express"); const router = express.Router(); const { saveSettings, getSettings } = require("../database/db"); router.post("/", async (req, res) => { try { const { delay_ms, max_emails_per_day } = req.body; if (delay_ms === undefined || max_emails_per_day === undefined) { return res.status(400).json({ error: "Missing required settings fields" }); } if (delay_ms < 0 || max_emails_per_day < 1) { return res.status(400).json({ error: "Invalid settings values" }); } const settings = { delay_ms: parseInt(delay_ms), max_emails_per_day: parseInt(max_emails_per_day) }; const result = await saveSettings(settings); res.json({ success: true, message: "Settings saved successfully", settings: result }); } catch (error) { console.error("Error saving settings:", error); res.status(500).json({ error: "Failed to save settings" }); } }); router.get("/", async (req, res) => { try { const settings = await getSettings(); res.json({ success: true, settings }); } catch (error) { console.error("Error getting settings:", error); res.status(500).json({ error: "Failed to get settings" }); } }); module.exports = router;
